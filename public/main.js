var HNSM=function(){"use strict";function e(t){for(var r=[],n=0,a=t.length;n<a;n++){var s=t[n],i=s.content,o=[m.trust(i),m(".stats",s.time_ago+" by "+s.user)];s.comments.length&&o.push(e(s.comments)),0==s.level&&o.push(m(".divider")),r.push(m(".comment[style=margin-left: "+2*s.level+"rem]",o))}return r}function t(e){for(var t=0,r=this.length;t<r;t++)a.rmClass(this[t],"active");var n=e.target;n&&"a"==n.tagName.toLowerCase()&&a.adClass(n.parentNode,"active")}var r={base:"https://api.hackerwebapp.com/"},n=console.log.bind(console),a={items2dom:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var a=e[r],s=a.title;a.domain&&(s+=" ("+a.domain+")");var i=[];null!==a.points&&i.push(m("span.badge[data-badge="+a.points+"]","Points")),i.push(m("span.badge[data-badge="+a.comments_count+"]",m("a[href=#!/item/"+a.id+"]","Comments"))),a.user&&i.push(m("span.user",m("a[href=#!/user/"+a.user+"]","by "+a.user))),i.push(m("span.time",a.time_ago));for(var o=[],u=0,l=i.length;u<l;u++)o.push(m(".column.col-"+12/l,i[u]));var c=m(".news-item",[m("h5",m("a[href="+a.url+"][target=_blank][rel=noopener]",s)),m(".columns",o),m(".divider")]);t.push(c)}return t},comms2dom:e,adClass:function(e,t){var r=e.className.trim();return""==r?(e.className=t,1):r==t?0:r.indexOf(" "+t)>=0||r.indexOf(t+" ")>=0?0:(e.className+=" "+t,1)},rmClass:function(e,t){var r=e.className.trim();if(""==r)return 0;if(r==t)return e.className="",0;var n=" "+t;return r.indexOf(n)>=0?(e.className=e.className.replace(n,""),1):(n=t+" ",r.indexOf(n)>=0?(e.className=e.className.replace(n,""),1):0)},request:function(e){var t,r=sessionStorage;if(r&&(t=r.getItem(s+e)))try{var a=JSON.parse(t);return n("cache",a),new Promise(function(e){e(a)})}catch(e){n(e)}return m.request(e).then(function(t){return r&&r.setItem(s+e,JSON.stringify(t)),t})},log:n},s="hnsm-",i=function(e){return{loading:!0,items:[],oninit:function(){this.loading=!0;var t=m.route.param("page")||1,n=r.base+e+"?page="+t,s=this;a.request(n).then(function(e){s.items=e,s.loading=!1,m.redraw()})},view:function(){return this.loading?m(".loading"):a.items2dom(this.items)}}},o={loading:!0,user:!1,oninit:function(){this.loading=!0;var e=m.route.param("user"),t=r.base+"user/"+e,n=this;a.request(t).then(function(e){n.user=e,n.loading=!1})},view:function(){return this.loading?m(".loading"):(a.log(this.user),[m("h4",this.user.id),m(".karma","karma: "+this.user.karma),m(".time","created: "+this.user.created),m.trust(this.user.about)])}},u={loading:!0,item:!1,oninit:function(){this.loading=!0;var e=m.route.param("id"),t=r.base+"item/"+e,n=this;a.request(t).then(function(e){n.item=e,n.loading=!1})},view:function(){if(this.loading)return m(".loading");var e=[m("h4",this.item.title)];return 0!=this.item.url.indexOf("item?")&&e.push(m(".url",m("a[rel=noopener][target=_blank][href="+this.item.url+"]",this.item.url))),e.push(m(".stats",this.item.time_ago+" by "+this.item.user)),e.push(m("h5","Comments")),e.push(a.comms2dom(this.item.comments)),e}},l=document.getElementById("container");!function(){var e=location.hostname;if("localhost"==e||e.match(/\.localhost$/))return 0;if("https:"==location.protocol)return 0;var t=location.href.replace(/^http:/,"https:");location.href=t}(),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(e){a.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){a.log("ServiceWorker registration failed: ",e)})}),function(){var e=document.getElementById("navigation"),r=e.querySelectorAll(".tab-item");e.addEventListener("click",t.bind(r));var n=location.hash.substr(3).replace(/\/.*/,"");""==n&&(n="news");var a=e.querySelector("a[data-link="+n+"]");t.call(r,{target:a})}();var c={router:m.route(l,"/",{"/":i("news"),"/news/:page":i("news"),"/newest/:page":i("newest"),"/ask/:page":i("ask"),"/show/:page":i("show"),"/jobs/:page":i("jobs"),"/user/:user":o,"/item/:id":u})};return function(){var e=document.createElement("link");e.rel="stylesheet",e.href="ext/spectre.css",document.querySelector("head").appendChild(e)}(),c}();
//# sourceMappingURL=main.js.map
